<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Redis | 系统架构设计与优化</title>
    <meta name="generator" content="VuePress 1.5.3">
    <link rel="icon" href="https://i.loli.net/2020/02/25/AOjBhkIxtb8dRgl.png">
    <meta name="description" content="拥抱云时代容器化微服务化系统架构">
    <link rel="preload" href="/architecture/assets/css/0.styles.0ca1c2f4.css" as="style"><link rel="preload" href="/architecture/assets/js/app.4c91cc6b.js" as="script"><link rel="preload" href="/architecture/assets/js/2.45685ece.js" as="script"><link rel="preload" href="/architecture/assets/js/12.391d19f8.js" as="script"><link rel="prefetch" href="/architecture/assets/js/10.128458a5.js"><link rel="prefetch" href="/architecture/assets/js/11.49a15839.js"><link rel="prefetch" href="/architecture/assets/js/13.fc661aa7.js"><link rel="prefetch" href="/architecture/assets/js/3.f957054d.js"><link rel="prefetch" href="/architecture/assets/js/4.746e24b3.js"><link rel="prefetch" href="/architecture/assets/js/5.50f24f73.js"><link rel="prefetch" href="/architecture/assets/js/6.7643a53c.js"><link rel="prefetch" href="/architecture/assets/js/7.71363e0d.js"><link rel="prefetch" href="/architecture/assets/js/8.3884ef05.js"><link rel="prefetch" href="/architecture/assets/js/9.db45d323.js">
    <link rel="stylesheet" href="/architecture/assets/css/0.styles.0ca1c2f4.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/architecture/" class="home-link router-link-active"><!----> <span class="site-name">系统架构设计与优化</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/architecture/architecture/intro.html" class="nav-link">
  Get Start
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Books" class="dropdown-title"><span class="title">Books</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://ccstudio.org/python" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Python
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://ccstudio.org/dotnet" target="_blank" rel="noopener noreferrer" class="nav-link external">
  .Net Core
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://ccstudio.org/linux" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Linux
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div><div class="nav-item"><a href="https://ccstudio.org/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Blog
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <a href="https://github.com/colin-chang/architecture" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/architecture/architecture/intro.html" class="nav-link">
  Get Start
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Books" class="dropdown-title"><span class="title">Books</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://ccstudio.org/python" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Python
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://ccstudio.org/dotnet" target="_blank" rel="noopener noreferrer" class="nav-link external">
  .Net Core
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://ccstudio.org/linux" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Linux
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div><div class="nav-item"><a href="https://ccstudio.org/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Blog
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <a href="https://github.com/colin-chang/architecture" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>系统架构</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/architecture/architecture/intro.html" class="sidebar-link">系统架构发展</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/architecture/architecture/intro.html#_1-单服务器" class="sidebar-link">1. 单服务器</a></li><li class="sidebar-sub-header"><a href="/architecture/architecture/intro.html#_2-多服务器" class="sidebar-link">2. 多服务器</a></li><li class="sidebar-sub-header"><a href="/architecture/architecture/intro.html#_3-服务器集群" class="sidebar-link">3. 服务器集群</a></li><li class="sidebar-sub-header"><a href="/architecture/architecture/intro.html#_4-应用水平拆分-消息队列" class="sidebar-link">4. 应用水平拆分 + 消息队列</a></li><li class="sidebar-sub-header"><a href="/architecture/architecture/intro.html#_5-nosql-搜索引擎服务" class="sidebar-link">5. NoSQL + 搜索引擎服务</a></li></ul></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>数据库优化</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/architecture/database/lock.html" class="sidebar-link">数据库锁</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/architecture/database/lock.html#_1-数据库并发" class="sidebar-link">1. 数据库并发</a></li><li class="sidebar-sub-header"><a href="/architecture/database/lock.html#_2-数据库锁" class="sidebar-link">2. 数据库锁</a></li></ul></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>NoSQL</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/architecture/nosql/intro.html" class="sidebar-link">NoSQL</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/architecture/nosql/intro.html#_1-nosql简介" class="sidebar-link">1. NoSQL简介</a></li><li class="sidebar-sub-header"><a href="/architecture/nosql/intro.html#_2-nosql优缺点" class="sidebar-link">2. NoSQL优缺点</a></li><li class="sidebar-sub-header"><a href="/architecture/nosql/intro.html#_3-nosql-数据库分类" class="sidebar-link">3. NoSQL 数据库分类</a></li><li class="sidebar-sub-header"><a href="/architecture/nosql/intro.html#_4-网络安全" class="sidebar-link">4. 网络安全</a></li></ul></li><li><a href="/architecture/nosql/redis.html" aria-current="page" class="active sidebar-link">Redis</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/architecture/nosql/redis.html#_1-redis-简介" class="sidebar-link">1. Redis 简介</a></li><li class="sidebar-sub-header"><a href="/architecture/nosql/redis.html#_2-redis-安装" class="sidebar-link">2. Redis 安装</a></li><li class="sidebar-sub-header"><a href="/architecture/nosql/redis.html#_3-redis-数据类型" class="sidebar-link">3. Redis 数据类型</a></li><li class="sidebar-sub-header"><a href="/architecture/nosql/redis.html#_4-高级操作" class="sidebar-link">4. 高级操作</a></li><li class="sidebar-sub-header"><a href="/architecture/nosql/redis.html#_5-redis-集群" class="sidebar-link">5. Redis 集群</a></li><li class="sidebar-sub-header"><a href="/architecture/nosql/redis.html#_6-应用程序交互" class="sidebar-link">6. 应用程序交互</a></li></ul></li><li><a href="/architecture/nosql/mongo.html" class="sidebar-link">MongoDB</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/architecture/nosql/mongo.html#_1-mongo-基础" class="sidebar-link">1. Mongo 基础</a></li><li class="sidebar-sub-header"><a href="/architecture/nosql/mongo.html#_2-mongo-安装" class="sidebar-link">2. Mongo 安装</a></li><li class="sidebar-sub-header"><a href="/architecture/nosql/mongo.html#_3-mongo-数据类型" class="sidebar-link">3. Mongo 数据类型</a></li><li class="sidebar-sub-header"><a href="/architecture/nosql/mongo.html#_4-mongo-shell" class="sidebar-link">4. Mongo Shell</a></li><li class="sidebar-sub-header"><a href="/architecture/nosql/mongo.html#_5-索引" class="sidebar-link">5. 索引</a></li><li class="sidebar-sub-header"><a href="/architecture/nosql/mongo.html#_6-安全管理" class="sidebar-link">6. 安全管理</a></li><li class="sidebar-sub-header"><a href="/architecture/nosql/mongo.html#_7-mongo-集群" class="sidebar-link">7. Mongo 集群</a></li><li class="sidebar-sub-header"><a href="/architecture/nosql/mongo.html#_8-应用程序交互" class="sidebar-link">8. 应用程序交互</a></li></ul></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>分布式日志</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/architecture/log/elk.html" class="sidebar-link">ELK</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/architecture/log/elk.html#_1-简介" class="sidebar-link">1. 简介</a></li><li class="sidebar-sub-header"><a href="/architecture/log/elk.html#_2-elk环境搭建" class="sidebar-link">2. ELK环境搭建</a></li><li class="sidebar-sub-header"><a href="/architecture/log/elk.html#_3-记录日志" class="sidebar-link">3. 记录日志</a></li><li class="sidebar-sub-header"><a href="/architecture/log/elk.html#_4-查看日志" class="sidebar-link">4. 查看日志</a></li></ul></li><li><a href="/architecture/log/exceptionless.html" class="sidebar-link">Exceptionless</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/architecture/log/exceptionless.html#_1-简介" class="sidebar-link">1. 简介</a></li><li class="sidebar-sub-header"><a href="/architecture/log/exceptionless.html#_2-简单使用" class="sidebar-link">2. 简单使用</a></li><li class="sidebar-sub-header"><a href="/architecture/log/exceptionless.html#_3-进阶使用" class="sidebar-link">3. 进阶使用</a></li><li class="sidebar-sub-header"><a href="/architecture/log/exceptionless.html#_4-异常日志模块封装" class="sidebar-link">4. 异常日志模块封装</a></li><li class="sidebar-sub-header"><a href="/architecture/log/exceptionless.html#_5-本地部署" class="sidebar-link">5. 本地部署</a></li></ul></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>TODO</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/architecture/todo.html" class="sidebar-link">Todo List</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/architecture/todo.html#_1-to-finish" class="sidebar-link">1. To finish</a></li><li class="sidebar-sub-header"><a href="/architecture/todo.html#_2-todo" class="sidebar-link">2. Todo</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="redis"><a href="#redis" class="header-anchor">#</a> Redis</h1> <h2 id="_1-redis-简介"><a href="#_1-redis-简介" class="header-anchor">#</a> 1. Redis 简介</h2> <p>Redis 是一个支持数据结构更多的键值对数据库。它的值不仅可以是字符串等基本数据 类型,也可以是类对象,更可以是 Set、List、计数器等高级的数据结构。</p> <p>Memcached 也可以保存类似于 Set、List 这样的结构,但是如果说要向 List 中增加元素, Memcached 则需要把 List 全部元素取出来,然后再把元素增加进去,然后再保存回去,不仅效率低,而且有并发访问问题。Redis 内置的 Set、List 等可以直接支持增加、删除元素的 操作,效率很高,操作是原子的。</p> <p>Memcached 数据存在内存中,memcached 重启后数据就消失;而 Redis 会把数据持久化到硬盘中,Redis 重启后数据还存在。</p> <ol><li>优点</li></ol> <ul><li>支持 string、list、set、geo 等复杂的数据结构。</li> <li>高命中的数据运行时是在内存中,数据最终还是可以保存到磁盘中,这样服务器重 启之后数据还在。</li> <li>服务器是单线程的,来自所有客户端的所有命令都是串行执行的,因此不用担心并 发修改(串行操作当然还是有并发问题)的问题,编程模型简单;</li> <li>支持消息订阅/通知机制,可以用作消息队列;</li> <li>Key、Value 最大长度允许 512M;</li></ul> <ol start="2"><li>缺点</li></ol> <ul><li>Redis 是单线程的,因此单个 Redis 实例只能使用一个 CPU 核,不能充分发挥服务器的性能。可以在一台服务器上运行多个 Redis 实例,不同实例监听不同端口,再互相组成集群。</li> <li>做缓存性能不如 Memcached;</li></ul> <p>Redis高级教程参阅 <a href="https://blog.csdn.net/hjm4702192/article/details/80518856" target="_blank" rel="noopener noreferrer">https://blog.csdn.net/hjm4702192/article/details/80518856<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h2 id="_2-redis-安装"><a href="#_2-redis-安装" class="header-anchor">#</a> 2. Redis 安装</h2> <p>推荐使用Docker方式搭建redis服务器，简单高效。</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>docker run <span class="token punctuation">\</span>
-d <span class="token punctuation">\</span>
--name redis <span class="token punctuation">\</span>
-p <span class="token number">6379</span>:6379 <span class="token punctuation">\</span>
redis:alpine <span class="token punctuation">\</span>
--requirepass <span class="token string">&quot;password&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>在安装Redis时会同时安装服务端和客户端。服务端为<code>redis-server</code>客户端为<code>redis-cli</code>。可以使用客户端执行 Redis Shell 命令。需要了解 Redis Shell 的读者可以参阅 <a href="https://ccstudio.org/python/database/redis.html" target="_blank" rel="noopener noreferrer">redis driver for python<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> (接口与 Redis Shell 基本一致)。</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token comment"># 连接本地redis服务</span>
redis-cli -p <span class="token number">6379</span> -a password

keys * <span class="token comment"># get all keys</span>
<span class="token builtin class-name">set</span> name Colin <span class="token comment"># set a string value</span>
get name <span class="token comment"># get a string value of name</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>除了使用Redis提供的命令行客户端，我们也可以使用第三方GUI客户端，如<a href="https://github.com/uglide/RedisDesktopManager/" target="_blank" rel="noopener noreferrer">Redis Desktop Manager<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>等。一般客户端软件也提供了Redis命令行。</p> <p><img src="https://i.loli.net/2020/02/25/wLeXlUBIHsmtYfG.jpg" alt="Redis Desktop Manager"></p> <h2 id="_3-redis-数据类型"><a href="#_3-redis-数据类型" class="header-anchor">#</a> 3. Redis 数据类型</h2> <h3 id="_3-1-基础知识"><a href="#_3-1-基础知识" class="header-anchor">#</a> 3.1 基础知识</h3> <ul><li>不同系统放到 Redis 中的数据是不隔离的,因此设定 Key 的时候也要特别注意。</li> <li>Redis 服务器默认建了 16 个数据库,Redis 的想法是让大家把不同系统的数据放到不同的数据库中。但是建议大家不要这样用,因为 Redis 是单线程的,不同业务都放到同一个 Redis 实例的话效率不高,建议放到不同的实例中。因此尽量只用默认的 db0 数据库。</li> <li>Redis 支持的数据结构有 string、list、set、sortedset、hash、geo(redis 3.2 以上版本)。对应的 Redis 客户端里的方法都是 StringXXX、HashXXX、GeoXXX 等方法。不同数据类型的操作方 法不能混用,比如不能用 ListXXX 写入的值用 StringXXX 去读取或者写入等操作。</li> <li>Redis的所有数据类型本质上最终存储的都是String类型，Set等高级类型只是使用不同数据结构管理String类型。所以Redis中并不能存储复杂对象，但可序列化后存储。</li></ul> <h3 id="_3-2-redis-driver"><a href="#_3-2-redis-driver" class="header-anchor">#</a> 3.2 Redis Driver</h3> <p>Redis作为流行的内NoSQL内存数据库，各主流平台都提供了相应的Driver，下面我们以.Net平台为例，其他平台基本类似。</p> <p>.NET Core平台下，ServiceStack.Redis 是商业版，免费版有限制。StackExchange.Redis 2.0之前版本有超时问题，现已解决。除了这两个传统的库之外，国内大牛也开了一些优秀的高性能.Net Core的Redis组件，供我们选择。</p> <ul><li><a href="http://git.newlifex.com/NewLife/NewLife.Redis" target="_blank" rel="noopener noreferrer">NewLife.Redis<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 他是NewLife团队开发的，已经在ZTO大数据实时计算中广泛应用，200多个Redis实例稳定工作一年多，每天处理近1亿包裹数据，日均调用量80亿次。</li> <li><a href="https://github.com/2881099/csredis" target="_blank" rel="noopener noreferrer">CSRedis<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> (这里我更喜欢把它叫做CSRedisCore)这是另一个国内大牛nicye 开发的，为人很低调，所以了解他的人很少！目前我项目中广泛使用的也是这个。作者前不久刚做了一个几大Redis组件的性能测试.net core 2.0 redis驱动性能比拼 有兴趣的可以打开链接看一下。</li></ul> <p>详细对比和使用方式可参阅以下文档：</p> <ul><li>https://www.cnblogs.com/yilezhu/p/9947905.html</li> <li>https://www.cnblogs.com/yilezhu/p/9941208.html</li></ul> <p>下面我们以使用最广泛的<a href="https://stackexchange.github.io/StackExchange.Redis/" target="_blank" rel="noopener noreferrer">StackExchange.Redis<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>为例讲解。</p> <div class="custom-block warning"><p class="custom-block-title">Redis 连接</p> <p>官方推荐在程序中建立单例 Redis 连接对象进行复用，而不像关系型数据库连接每次用完释放。</p></div> <div class="language-csharp line-numbers-mode"><pre class="language-csharp"><code><span class="token class-name"><span class="token keyword">var</span></span> redis <span class="token operator">=</span> ConnectionMultiplexer<span class="token punctuation">.</span><span class="token function">Connect</span><span class="token punctuation">(</span><span class="token string">&quot;localhost:6379&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//官方推荐重用Redis连接而不是每次用完释放</span>
<span class="token class-name">IDatabase</span> db <span class="token operator">=</span> redis<span class="token punctuation">.</span><span class="token function">GetDatabase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//默认访问 db0 数据库,可以指定数字访问不同的数据库</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li>支持设置过期时间:<code>db.StringSet(&quot;key&quot;, &quot;value&quot;, TimeSpan.FromSeconds(10))</code></li> <li>获取数据:<code>string s = db.StringGet(&quot;key&quot;)</code>如果查不到则返回 null</li> <li>参数、返回值 <code>RedisKey</code>、<code>RedisValue</code> 类型,进行了运算符重载,可以和 <code>string</code>、 <code>byte[]</code>之间进行隐式转换。</li></ul> <h3 id="_3-4-key"><a href="#_3-4-key" class="header-anchor">#</a> 3.4 Key</h3> <p>Redis 里所有数据类型都是用 Key-Value 保存,因此 <strong>Key 操作是针对所有数据类型</strong>。</p> <table><thead><tr><th style="text-align:left;">方法</th> <th style="text-align:left;">作用</th></tr></thead> <tbody><tr><td style="text-align:left;"><code>KeyDelete(RedisKey key)</code></td> <td style="text-align:left;">根据 Key 删除;</td></tr> <tr><td style="text-align:left;"><code>KeyExists(RedisKey key)</code></td> <td style="text-align:left;">判断 Key 是否存在,存在并发问题;</td></tr> <tr><td style="text-align:left;"><code>KeyExpire(RedisKey key, TimeSpan? expiry)</code></td> <td style="text-align:left;">设置过期时间</td></tr></tbody></table> <h3 id="_3-5-string"><a href="#_3-5-string" class="header-anchor">#</a> 3.5 String</h3> <table><thead><tr><th style="text-align:left;">方法</th> <th style="text-align:left;">作用</th></tr></thead> <tbody><tr><td style="text-align:left;">db.StringAppend(RedisKey key, RedisValue value)</td> <td style="text-align:left;">附加内容,不存在则新建;</td></tr> <tr><td style="text-align:left;">db.StringIncrement(&quot;count&quot;, 2.5)</td> <td style="text-align:left;">计数器加值</td></tr> <tr><td style="text-align:left;">db.StringDecrement(&quot;count&quot;,1)</td> <td style="text-align:left;">计数器减值</td></tr></tbody></table> <p>计数器不存在则从0开始计，可以以此来计算新闻点击量、点赞量,非常高效。</p> <h3 id="_3-6-list"><a href="#_3-6-list" class="header-anchor">#</a> 3.6 List</h3> <p>Redis 中 List是双向链表，长度是无限，左右都可出入元素。可以当成双向队列或者双向栈用,比如可以把聊天记录、商品的物流信息等保存到 List 中。</p> <table><thead><tr><th style="text-align:left;">方法</th> <th style="text-align:left;">作用</th></tr></thead> <tbody><tr><td style="text-align:left;">ListLeftPush(RedisKey key, RedisValue value)</td> <td style="text-align:left;">从左侧压栈</td></tr> <tr><td style="text-align:left;">RedisValue ListLeftPop(RedisKey key)</td> <td style="text-align:left;">从左侧弹出</td></tr> <tr><td style="text-align:left;">ListRightPush(RedisKey key, RedisValue value)</td> <td style="text-align:left;">从右侧压栈</td></tr> <tr><td style="text-align:left;">RedisValue ListRightPop(RedisKey key)</td> <td style="text-align:left;">从右侧弹出</td></tr> <tr><td style="text-align:left;">RedisValue ListGetByIndex(RedisKey key, long index)</td> <td style="text-align:left;">获取 List 中第 index 个元素的值</td></tr> <tr><td style="text-align:left;">long ListLength(RedisKey key)</td> <td style="text-align:left;">获取List 中元素个数</td></tr> <tr><td style="text-align:left;">RedisValue[] ListRange(RedisKey key, long start = 0, long stop = -1)</td> <td style="text-align:left;">读但不取出元素</td></tr></tbody></table> <p><em>ListGetByIndex,ListLength 会有并发问题</em></p> <p>左进左出或右进右出则可作为栈使用，左进右出或右进左出则可作为队列使用。可以使用Redis的List用作轻量的消息队列使用。</p> <h3 id="_3-7-set"><a href="#_3-7-set" class="header-anchor">#</a> 3.7 Set</h3> <p>Set 是一个元素去重的集合。如使用 Set 保存禁用用户 id 等,就不用做重复性判断了。</p> <p>注意 Set 不是按照插入顺序遍历的,而是按照自己的一个存储方式来遍历。</p> <table><thead><tr><th style="text-align:left;">方法</th> <th style="text-align:left;">作用</th></tr></thead> <tbody><tr><td style="text-align:left;">bool SetAdd(RedisKey key, RedisValue value)</td> <td style="text-align:left;">向 Set 中增加元素，如果已存在则返回false</td></tr> <tr><td style="text-align:left;">bool SetContains(RedisKey key, RedisValue value)</td> <td style="text-align:left;">判断 Set 中是否存在某个元素</td></tr> <tr><td style="text-align:left;">long SetLength(RedisKey key)</td> <td style="text-align:left;">获得 Set 中元素的个数</td></tr> <tr><td style="text-align:left;">SetRemove(RedisKey key, RedisValue value)</td> <td style="text-align:left;">从 Set 中删除元素</td></tr> <tr><td style="text-align:left;">RedisValue[] SetMembers(RedisKey key)</td> <td style="text-align:left;">获取集合中的元素</td></tr></tbody></table> <p><em>SetContains,SetLength 会有并发问题</em></p> <h3 id="_3-8-sortedset-zset"><a href="#_3-8-sortedset-zset" class="header-anchor">#</a> 3.8 SortedSet(ZSet)</h3> <p>与Set相比SortedSet除了key,value外还提供了一个score字段记录数据记录的“分数”。如果对于数据遍历顺序有要求,可以使用 SortedSet,它会按照分数来进行遍历。<strong>SortedSet也称 ZSet</strong>。</p> <table><thead><tr><th style="text-align:left;">方法</th> <th style="text-align:left;">作用</th></tr></thead> <tbody><tr><td style="text-align:left;">SortedSetAdd(RedisKey key, RedisValue member, double score)</td> <td style="text-align:left;">添加数据记录和分数,如果存在则覆盖</td></tr> <tr><td style="text-align:left;">double SortedSetIncrement(RedisKey key, RedisValue member, double value)</td> <td style="text-align:left;">增加分数</td></tr> <tr><td style="text-align:left;">double SortedSetDecrement(RedisKey key, RedisValue member, double value)</td> <td style="text-align:left;">减少分数</td></tr> <tr><td style="text-align:left;">SortedSetEntry[] SortedSetRangeByRankWithScores(RedisKey key, long start = 0, long stop = -1, Order order = Order.Ascending)</td> <td style="text-align:left;">根据排序返回元素以及元素的分数。start、stop 用来分页查询、order 指定排序规则。</td></tr> <tr><td style="text-align:left;">RedisValue[] SortedSetRangeByRank(RedisKey key, long start = 0, long stop = -1, Order order = Order.Ascending)</td> <td style="text-align:left;">根据排序返回，如返回TOP10元素</td></tr> <tr><td style="text-align:left;">RedisValue[] SortedSetRangeByScore(RedisKey key, double start = double.NegativeInfinity, double stop = double.PositiveInfinity, Exclude exclude = Exclude.None, Order order = Order.Ascending, long skip = 0, long take = -1)</td> <td style="text-align:left;">根据分数返回。如返回大于90分的元素</td></tr></tbody></table> <div class="custom-block tip"><p class="custom-block-title">应用场景</p> <ul><li>热搜榜。每搜一次一个关键词,就给这个关键词加一分，最后提取 TOP-N 即可</li> <li>热门商品</li> <li>积分投票</li></ul></div> <h3 id="_3-9-hash"><a href="#_3-9-hash" class="header-anchor">#</a> 3.9 Hash</h3> <p>Hash的value 是一个“键值对集合”或者值是另外一个 Dictionary。可以用于存储对象，类似于Json方式存储对象。</p> <h3 id="_3-10-geo"><a href="#_3-10-geo" class="header-anchor">#</a> 3.10 Geo</h3> <p>Geo 是 Redis 3.2 版本后新增的数据类型,用来保存兴趣点(POI,point of interest)的坐标信息。 可以实现计算两 POI 之间的距离、获取一个点周边指定距离的 POI。可用于搜索指定地理位置周边的数据，如嘀嘀打车，附近的人等。</p> <h2 id="_4-高级操作"><a href="#_4-高级操作" class="header-anchor">#</a> 4. 高级操作</h2> <h3 id="_4-1-批量操作"><a href="#_4-1-批量操作" class="header-anchor">#</a> 4.1 批量操作</h3> <p>频繁操作会影响Redis性能,我们可以使用批量操作来较少请求次数。</p> <ul><li><ol><li>数组操作
几乎所有操作都支持数组类型,这样就可以一次性操作多条数据,如SortedSetAdd(RedisKey key, SortedSetEntry[] values)</li></ol></li> <li><ol start="2"><li>批量模式</li></ol></li></ul> <div class="language-csharp line-numbers-mode"><pre class="language-csharp"><code><span class="token class-name">IBatch</span> batch <span class="token operator">=</span> db<span class="token punctuation">.</span><span class="token function">CreateBatch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
db<span class="token punctuation">.</span><span class="token function">StringSet</span><span class="token punctuation">(</span><span class="token string">&quot;abc&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;123&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
db<span class="token punctuation">.</span><span class="token function">GeoAdd</span><span class="token punctuation">(</span><span class="token string">&quot;ShopsGeo1&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">GeoEntry</span><span class="token punctuation">(</span><span class="token number">116.34039</span><span class="token punctuation">,</span> <span class="token number">39.94218</span><span class="token punctuation">,</span> <span class="token string">&quot;1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
batch<span class="token punctuation">.</span><span class="token function">Execute</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>CreateBatch()、Execute()之间的操作会一次性提交给Redis服务器。</p> <h3 id="_4-2-发布订阅"><a href="#_4-2-发布订阅" class="header-anchor">#</a> 4.2 发布订阅</h3> <p>Redis 发布订阅(pub/sub)是一种消息通信模式：发送者(pub)发送消息，订阅者(sub)接收消息。Redis 客户端可以订阅任意数量的频道。</p> <p><img src="https://i.loli.net/2020/02/25/XA67JW3EOu2Icqg.png" alt="Redis发布订阅示意图"></p> <div class="language-csharp line-numbers-mode"><pre class="language-csharp"><code><span class="token comment">//发布</span>
<span class="token class-name"><span class="token keyword">var</span></span> pub <span class="token operator">=</span> ConnectionMultiplexer<span class="token punctuation">.</span><span class="token function">Connect</span><span class="token punctuation">(</span>connectionString<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">GetSubscriber</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">await</span> pub<span class="token punctuation">.</span><span class="token function">PublishAsync</span><span class="token punctuation">(</span><span class="token string">&quot;channel1&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;message content&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language-csharp line-numbers-mode"><pre class="language-csharp"><code><span class="token comment">//订阅</span>
<span class="token class-name"><span class="token keyword">var</span></span> pub <span class="token operator">=</span> ConnectionMultiplexer<span class="token punctuation">.</span><span class="token function">Connect</span><span class="token punctuation">(</span>connectionString<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">GetSubscriber</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">await</span> pub<span class="token punctuation">.</span><span class="token function">SubscribeAsync</span><span class="token punctuation">(</span><span class="token string">&quot;channle1&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>chn<span class="token punctuation">,</span> msg<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>发布订阅和List作队列使用，分别实现了发布订阅模式和生产者消费者模式，可以作轻量级消息队列使用，处理并发和解除应用间耦合关系等。</p> <h3 id="_4-3-分布式锁"><a href="#_4-3-分布式锁" class="header-anchor">#</a> 4.3 分布式锁</h3> <p>多线程中的 lock 等的作用范围是当前的程序范围内的,如果想跨多台服务器的锁(尽量避免这样搞),就要使用分布式锁，如作秒杀活动等。</p> <p>分布式锁一般有三种实现方式：</p> <ul><li>数据库乐观锁</li> <li>基于Redis的分布式锁</li> <li>基于ZooKeeper的分布式锁</li></ul> <p>这里我们主要介绍基于Redis的分布式锁。</p> <div class="language-csharp line-numbers-mode"><pre class="language-csharp"><code><span class="token comment">/// &lt;summary&gt;</span>
<span class="token comment">/// 获取分布式锁并执行</span>
<span class="token comment">/// &lt;/summary&gt;</span>
<span class="token comment">/// &lt;param name=&quot;action&quot;&gt;获取锁成功时执行的业务方法&lt;/param&gt;</span>
<span class="token comment">/// &lt;param name=&quot;key&quot;&gt;要锁定的key。用相同且唯一的key来当竞争对象,即要锁的对象&lt;/param&gt;</span>
<span class="token comment">/// &lt;param name=&quot;value&quot;&gt;给value赋值是为了明确锁是哪个请求加的,解锁时也必须是具有相同value的请求才能解锁，保证不会被其他请求解锁。&lt;/param&gt;</span>
<span class="token comment">/// &lt;param name=&quot;expiryMillisecond&quot;&gt;超时时间&lt;/param&gt;</span>
<span class="token comment">/// &lt;returns&gt;竞争锁是否成功&lt;/returns&gt;</span>
<span class="token keyword">public</span> <span class="token keyword">async</span> <span class="token return-type class-name">Task<span class="token punctuation">&lt;</span><span class="token keyword">bool</span><span class="token punctuation">&gt;</span></span> <span class="token function">LockExecuteAsync</span><span class="token punctuation">(</span><span class="token class-name">Action</span> action<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">string</span></span> key<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">string</span></span> <span class="token keyword">value</span><span class="token punctuation">,</span>
    <span class="token class-name"><span class="token keyword">int</span></span> expiryMillisecond <span class="token operator">=</span> <span class="token number">3000</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token comment">//竞争锁</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">await</span> Db<span class="token punctuation">.</span><span class="token function">LockTakeAsync</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> <span class="token keyword">value</span><span class="token punctuation">,</span> TimeSpan<span class="token punctuation">.</span><span class="token function">FromMilliseconds</span><span class="token punctuation">(</span>expiryMillisecond<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>

    <span class="token keyword">try</span>
    <span class="token punctuation">{</span>
        <span class="token comment">//获取锁后执行业务方法</span>
        <span class="token function">action</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">finally</span>
    <span class="token punctuation">{</span>
        Db<span class="token punctuation">.</span><span class="token function">LockRelease</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> <span class="token keyword">value</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//解锁</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><div class="language-csharp line-numbers-mode"><pre class="language-csharp"><code><span class="token class-name"><span class="token keyword">var</span></span> guid <span class="token operator">=</span> Guid<span class="token punctuation">.</span><span class="token function">NewGuid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
Redis<span class="token punctuation">.</span><span class="token function">LockExecuteAsync</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span>Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">&quot;成功抢到锁&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">&quot;lockKey&quot;</span><span class="token punctuation">,</span>guid<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="_5-redis-集群"><a href="#_5-redis-集群" class="header-anchor">#</a> 5. Redis 集群</h2> <h3 id="_5-1-主从架构"><a href="#_5-1-主从架构" class="header-anchor">#</a> 5.1 主从架构</h3> <p>Redis可以配置<code>master-slave</code>模式来实现读写分离，数据备份和故障转移等功能。一般master节点用于写数据，而数据读取可以直接访问slave节点，slave节点数据默认只读。</p> <p><img src="https://i.loli.net/2020/02/25/QzB8V7LZPUCAKFl.jpg" alt="Redis横向主从结构"></p> <p>master节点可以配置多slave节点，master的slave节点太多会增加主从同步资源开销,可以使用下面的拓扑结构减轻主节点推送的压力。</p> <p><img src="https://i.loli.net/2020/02/25/nVvcIrXmzxRUB6M.jpg" alt="Redis纵向主从结构"></p> <p>下面是一个“一主二从”的docker-compose示例。</p> <div class="language-yml line-numbers-mode"><pre class="language-yml"><code><span class="token key atrule">version</span><span class="token punctuation">:</span> <span class="token string">'3.7'</span>

<span class="token key atrule">services</span><span class="token punctuation">:</span>
  <span class="token key atrule">redis-master</span><span class="token punctuation">:</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> redis<span class="token punctuation">:</span>alpine
    <span class="token key atrule">container_name</span><span class="token punctuation">:</span> redis<span class="token punctuation">-</span>master
    <span class="token key atrule">command</span><span class="token punctuation">:</span> redis<span class="token punctuation">-</span>server <span class="token punctuation">-</span><span class="token punctuation">-</span>requirepass master_password
    <span class="token key atrule">ports</span><span class="token punctuation">:</span> 
      <span class="token punctuation">-</span> <span class="token string">&quot;6379:6379&quot;</span>
    <span class="token key atrule">restart</span><span class="token punctuation">:</span> always

  <span class="token key atrule">redis-slave1</span><span class="token punctuation">:</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> redis<span class="token punctuation">:</span>alpine
    <span class="token key atrule">container_name</span><span class="token punctuation">:</span> redis<span class="token punctuation">-</span>slave1
    <span class="token key atrule">command</span><span class="token punctuation">:</span> redis<span class="token punctuation">-</span>server <span class="token punctuation">-</span><span class="token punctuation">-</span>slaveof redis<span class="token punctuation">-</span>master 6379 <span class="token punctuation">-</span><span class="token punctuation">-</span>masterauth master_password <span class="token punctuation">-</span><span class="token punctuation">-</span>port 6380 <span class="token punctuation">-</span><span class="token punctuation">-</span>requirepass slave_password
    <span class="token key atrule">ports</span><span class="token punctuation">:</span> 
      <span class="token punctuation">-</span> <span class="token string">&quot;6380:6380&quot;</span>
    <span class="token key atrule">restart</span><span class="token punctuation">:</span> always
    <span class="token key atrule">depends_on</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> redis<span class="token punctuation">-</span>master

  <span class="token key atrule">redis-slave2</span><span class="token punctuation">:</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> redis<span class="token punctuation">:</span>alpine
    <span class="token key atrule">container_name</span><span class="token punctuation">:</span> redis<span class="token punctuation">-</span>slave2
    <span class="token key atrule">command</span><span class="token punctuation">:</span> redis<span class="token punctuation">-</span>server <span class="token punctuation">-</span><span class="token punctuation">-</span>slaveof redis<span class="token punctuation">-</span>master 6379 <span class="token punctuation">-</span><span class="token punctuation">-</span>masterauth master_password <span class="token punctuation">-</span><span class="token punctuation">-</span>port 6381 <span class="token punctuation">-</span><span class="token punctuation">-</span>requirepass slave_password
    <span class="token key atrule">ports</span><span class="token punctuation">:</span> 
      <span class="token punctuation">-</span> <span class="token string">&quot;6381:6381&quot;</span>
    <span class="token key atrule">restart</span><span class="token punctuation">:</span> always
    <span class="token key atrule">depends_on</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> redis<span class="token punctuation">-</span>master
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br></div></div><p>主从结构中只需要修改slave节点配置文件，添加<code>slaveof</code>参数绑定主节点即可。或者我们可以使用docker-compose来快速搭建一个主从结构的Reids环境。</p> <p>主从架构中如果master节点出现故障，需要人工选择和修改slave节点配置升级其为新的master节点，无法实现高可用性。高可用(主从复制、主从切换)redis集群有两种方案，一种是redis-sentinel，只有一个master，各实例数据保持一致；一种是redis-cluster，也叫分布式redis集群，可以有多个master，数据分片分布在这些master上。</p> <blockquote><p>redis标准配置文件 <a href="http://download.redis.io/redis-stable/redis.conf" target="_blank" rel="noopener noreferrer">http://download.redis.io/redis-stable/redis.conf<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></blockquote> <h3 id="_5-2-redis-sentinel"><a href="#_5-2-redis-sentinel" class="header-anchor">#</a> 5.2 redis-sentinel</h3> <p>哨兵机制(sentinel)可以在主节点出现故障时，由Redis Sentinel自动完成故障发现和转移，并通知应用方，实现高可用性。</p> <p>redis-sentinel作为独立的服务，用于管理多个redis实例，该系统主要执行以下四个任务：</p> <ul><li>监控 (Monitor): 检查redis主、从实例是否正常运作</li> <li>通知 (Notification): 监控的redis服务出现问题时，可通过API发送通知告警</li> <li>自动故障迁移 (Automatic Failover): 当检测到redis主库不能正常工作时，redis-sentinel会开始做自动故障判断、迁移等操作，先是移除失效redis主服务，然后将其中一个从服务器升级为新的主服务器，并让失效主服务器的其他从服务器改为复制新的主服务器。当客户端试图连接失效的主服务器时，集群也会向客户端返回最新主服务器的地址，使得集群可以使用新的主服务器来代替失效服务器</li> <li>配置中心。sentinel启动时指定了mater节点，并可自动发现和动态更新slave节点。它可为应用程序提供集群中所有节点信息。</li></ul> <p>我们只需要配置master节点即可，Sentinel会自动发现slave节点并动态更新配置。</p> <p>Redis至少使用三个Sentinel节点。sentinel.conf简单配置如下。</p> <div class="language-conf line-numbers-mode"><pre class="language-text"><code>port 26379

# bind to master node.the 'redis-service' is an alias.
# redis-master 6379 is the address of master node
# The quorum was set to the value of 2 (last argument of sentinel monitor configuration directive).
sentinel monitor redis-service redis-master 6379 2

# down-after-milliseconds value is 5000 milliseconds, that is 5 seconds, so masters will be detected as failing as soon as we don't receive any reply from our pings within this amount of time.
sentinel down-after-milliseconds redis-service 5000

sentinel failover-timeout redis-service 60000
sentinel parallel-syncs redis-service 1

sentinel auth-pass redis-service master_password
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p><img src="https://i.loli.net/2020/02/25/tmP4hzVXL6MNurB.jpg" alt="Redis哨兵机制"></p> <ul><li>Docker方式搭建推荐使用 <a href="https://hub.docker.com/r/grokzen/redis-cluster" target="_blank" rel="noopener noreferrer">grokzen/redis-cluster<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>镜像。</li> <li>应用程序与redis-sentinel集群交互示例参阅 <a href="https://ccstudio.org/python/database/redis.html#_2-1-redis-sentinel" target="_blank" rel="noopener noreferrer">https://ccstudio.org/python/database/redis.html#_2-1-redis-sentinel<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <blockquote><p>参考资料</p></blockquote> <ul><li>Sentinel官方文档: <a href="https://redis.io/topics/sentinel" target="_blank" rel="noopener noreferrer">https://redis.io/topics/sentinel<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li>标准配置文件: <a href="http://download.redis.io/redis-stable/sentinel.conf" target="_blank" rel="noopener noreferrer">http://download.redis.io/redis-stable/sentinel.conf<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://www.cnblogs.com/hckblogs/p/11186311.html" target="_blank" rel="noopener noreferrer">https://www.cnblogs.com/hckblogs/p/11186311.html<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://blog.51cto.com/8939110/2429771" target="_blank" rel="noopener noreferrer">https://blog.51cto.com/8939110/2429771<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <h3 id="_5-3-redis-cluster"><a href="#_5-3-redis-cluster" class="header-anchor">#</a> 5.3 redis-cluster</h3> <p>Redis3.0版本之前，可以通过Redis Sentinel来实现高可用，从3.0版本之后，官方推出了Redis Cluster，它的主要用途是实现数据分片(Data Sharding)，同样可以实现高可用，是官方当前推荐的方案。
·
redis cluster在设计的时候，就考虑到了去中⼼化，去中间件，集群中的每个节点都是平等的，每个节点都保存各⾃的数据和整个集群的状态。每个节点都和其他所有节点连接，⽽且这些连接保持活跃，保证只需要连接集群中任意节点，都可获取到其他节点的数据。</p> <p><img src="https://i.loli.net/2020/02/25/iUYerCkMWEFca7l.jpg" alt="redis-cluster-slot"></p> <p>在Redis Sentinel模式中，每个节点需要保存全量数据，冗余比较多，而在Redis Cluster模式中，每个分片只需要保存一部分的数据。 Redis Cluster的具体实现细节是采用了Hash槽的概念，集群会预先分配16384个槽，并将这些槽分配给具体的服务节点，通过对Key进行CRC16(key)%16384运算得到对应的槽是哪一个，从而将读写操作转发到该槽所对应的服务节点。当有新的节点加入或者移除的时候，再来迁移这些槽以及其对应的数据。在这种设计之下，我们就可以很方便的进行动态扩容或缩容。</p> <p>Redis Cluster同样采用Master-Salve模式，写数据在master节点，它会与其对应的salve进⾏数据同步。当读取数据时，也根据⼀致性哈希算法到对应的master节点获取数据。当⼀个master挂掉之后，会自动切换其对应salve节点为新master节点。</p> <p><strong>redis-cluster要求至少3个主节点(否则在创建集群时会失败)</strong>，并且当存活的主节点数⼩于总节点数的⼀半时，整个集群就⽆法提供服务了。</p> <ul><li>Docker方式搭建推荐使用 <a href="https://hub.docker.com/r/grokzen/redis-cluster" target="_blank" rel="noopener noreferrer">grokzen/redis-cluster<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>镜像。</li> <li>物理机搭建教程参阅 <a href="https://www.cnblogs.com/wuxl360/p/5920330.html" target="_blank" rel="noopener noreferrer">https://www.cnblogs.com/wuxl360/p/5920330.html<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li>应用程序与redis-cluster交互示例参阅 <a href="https://ccstudio.org/python/database/redis.html#_2-2-redis-cluster" target="_blank" rel="noopener noreferrer">https://ccstudio.org/python/database/redis.html#_2-2-redis-cluster<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <blockquote><p>参考资料 <a href="https://redis.io/topics/cluster-tutorial/" target="_blank" rel="noopener noreferrer">官方文档<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></blockquote> <h2 id="_6-应用程序交互"><a href="#_6-应用程序交互" class="header-anchor">#</a> 6. 应用程序交互</h2> <blockquote><p>Python Redis交互请参阅 <a href="https://ccstudio.org/python/database/redis.html" target="_blank" rel="noopener noreferrer">https://ccstudio.org/python/database/redis.html<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。</p></blockquote> <p>Redis的大部分常用操作都是相同的，这里我们基于<code>StackExchange.Redis</code>和<code>.Net Standard 2.0</code>封装一个帮助类。</p> <ul><li>包含String,List,Set,SortedSet,Hash等常用数据类型操作。</li> <li>支持发布订阅</li> <li>支持批量执行</li> <li>支持分布式锁</li></ul> <p>代码已上传到Github，这里不再展开。
https://github.com/colin-chang/RedisHelper</p> <p>具体使用方式可以查看单元测试
https://github.com/colin-chang/RedisHelper/blob/master/ColinChang.RedisHelper.Test/RedisHelperTest.cs</p> <blockquote><p><a href="https://www.nuget.org/packages/ColinChang.RedisHelper/" target="_blank" rel="noopener noreferrer">Nuget - ColinChang.RedisHelper<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></blockquote> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token comment"># Package Manager</span>
Install-Package ColinChang.RedisHelper

<span class="token comment"># .NET CLI</span>
dotnet <span class="token function">add</span> package ColinChang.RedisHelper
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">更新时间:</span> <span class="time">8/18/2020, 1:58:42 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/architecture/nosql/intro.html" class="prev">
        NoSQL
      </a></span> <span class="next"><a href="/architecture/nosql/mongo.html">
        MongoDB
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/architecture/assets/js/app.4c91cc6b.js" defer></script><script src="/architecture/assets/js/2.45685ece.js" defer></script><script src="/architecture/assets/js/12.391d19f8.js" defer></script>
  </body>
</html>
